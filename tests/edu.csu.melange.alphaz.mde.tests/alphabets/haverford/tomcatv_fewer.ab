float abs(float);

affine
	TOMCATV {ITACT,N | (ITACT,N)>4}
input
	float X0  {  i,j |               0<=(i,j)<N  };
	float Y0  {  i,j |               0<=(i,j)<N  };
output
	float RXM {t     | 1<=t<=ITACT                };
	float RYM {t     | 1<=t<=ITACT                };
local
	float D   {t,i,j | 1<=t<=ITACT && 1<=(i,j)<N-1};
	float RX  {t,i,j | 1<=t<=ITACT && 1<=(i,j)<N-1};
	float RY  {t,i,j | 1<=t<=ITACT && 1<=(i,j)<N-1};
	float X   {t,i,j | 0<=t<=ITACT && 0<=(i,j)<=N-1};
	float Y   {t,i,j | 0<=t<=ITACT && 0<=(i,j)<=N-1};
let
	D  [t,i,j] = case
	             {| j==1} : 1 / (2 * (0.25 * (X[t-1,i+1,j] - X[t-1,i-1,j]) * (X[t-1,i+1,j] - X[t-1,i-1,j]) + (Y[t-1,i+1,j] - Y[t-1,i-1,j]) * (Y[t-1,i+1,j] - Y[t-1,i-1,j])) + (0.25 * (X[t-1,i,j+1] - X[t-1,i,j-1]) * (X[t-1,i,j+1] - X[t-1,i,j-1]) + (Y[t-1,i,j+1] - Y[t-1,i,j-1]) * (Y[t-1,i,j+1] - Y[t-1,i,j-1])) * (2.0 / 0.98));
	             {| j>1} : 1 / ((2 * (0.25 * (X[t-1,i+1,j] - X[t-1,i-1,j]) * (X[t-1,i+1,j] - X[t-1,i-1,j]) + (Y[t-1,i+1,j] - Y[t-1,i-1,j]) * (Y[t-1,i+1,j] - Y[t-1,i-1,j])) + (0.25 * (X[t-1,i,j+1] - X[t-1,i,j-1]) * (X[t-1,i,j+1] - X[t-1,i,j-1]) + (Y[t-1,i,j+1] - Y[t-1,i,j-1]) * (Y[t-1,i,j+1] - Y[t-1,i,j-1])) * (2.0 / 0.98)) - (0.25 * (X[t-1,i+1,j-1] - X[t-1,i-1,j-1]) * (X[t-1,i+1,j-1] - X[t-1,i-1,j-1]) + (Y[t-1,i+1,j-1] - Y[t-1,i-1,j-1]) * (Y[t-1,i+1,j-1] - Y[t-1,i-1,j-1])) * (0.25 * (X[t-1,i+1,j] - X[t-1,i-1,j]) * (X[t-1,i+1,j] - X[t-1,i-1,j]) + (Y[t-1,i+1,j] - Y[t-1,i-1,j]) * (Y[t-1,i+1,j] - Y[t-1,i-1,j])) * D[t,i,j-1]);
	             esac;
	RX[t,i,j] = case
	             {| j==1} : ((0.25 * (X[t-1,i,j+1] - X[t-1,i,j-1]) * (X[t-1,i,j+1] - X[t-1,i,j-1]) + (Y[t-1,i,j+1] - Y[t-1,i,j-1]) * (Y[t-1,i,j+1] - Y[t-1,i,j-1])) * (X[t-1,i+1,j] - (2.0 * X[t-1,i,j]) + X[t-1,i-1,j]) + (0.25 * (X[t-1,i+1,j] - X[t-1,i-1,j]) * (X[t-1,i+1,j] - X[t-1,i-1,j]) + (Y[t-1,i+1,j] - Y[t-1,i-1,j]) * (Y[t-1,i+1,j] - Y[t-1,i-1,j])) * (X[t-1,i,j+1] - (2.0 * X[t-1,i,j]) + X[t-1,i,j-1]) - (0.125 * (X[t-1,i+1,j] - X[t-1,i-1,j]) * (X[t-1,i,j+1] - X[t-1,i,j-1]) + (Y[t-1,i+1,j] - Y[t-1,i-1,j]) * (Y[t-1,i,j+1] - Y[t-1,i,j-1])) * (X[t-1,i+1,j+1] - X[t-1,i+1,j-1] - X[t-1,i-1,j+1] + X[t-1,i-1,j-1])) + (0.25 * (X[t-1,i+1,j] - X[t-1,i-1,j]) * (X[t-1,i+1,j] - X[t-1,i-1,j]) + (Y[t-1,i+1,j] - Y[t-1,i-1,j]) * (Y[t-1,i+1,j] - Y[t-1,i-1,j])) * ((0.25 * (X[t-1,i,j+2] - X[t-1,i,j]) * (X[t-1,i,j+2] - X[t-1,i,j]) + (Y[t-1,i,j+2] - Y[t-1,i,j]) * (Y[t-1,i,j+2] - Y[t-1,i,j])) * (X[t-1,i+1,j+1] - (2.0 * X[t-1,i,j+1]) + X[t-1,i-1,j+1]) + (0.25 * (X[t-1,i+1,j+1] - X[t-1,i-1,j+1]) * (X[t-1,i+1,j+1] - X[t-1,i-1,j+1]) + (Y[t-1,i+1,j+1] - Y[t-1,i-1,j+1]) * (Y[t-1,i+1,j+1] - Y[t-1,i-1,j+1])) * (X[t-1,i,j+2] - (2.0 * X[t-1,i,j+1]) + X[t-1,i,j]) - (0.125 * (X[t-1,i+1,j+1] - X[t-1,i-1,j+1]) * (X[t-1,i,j+2] - X[t-1,i,j]) + (Y[t-1,i+1,j+1] - Y[t-1,i-1,j+1]) * (Y[t-1,i,j+2] - Y[t-1,i,j])) * (X[t-1,i+1,j+2] - X[t-1,i+1,j] - X[t-1,i-1,j+2] + X[t-1,i-1,j])) * D[t,i,j];
	             {| j==N-2} : (((0.25 * (X[t-1,i,j+1] - X[t-1,i,j-1]) * (X[t-1,i,j+1] - X[t-1,i,j-1]) + (Y[t-1,i,j+1] - Y[t-1,i,j-1]) * (Y[t-1,i,j+1] - Y[t-1,i,j-1])) * (X[t-1,i+1,j] - (2.0 * X[t-1,i,j]) + X[t-1,i-1,j]) + (0.25 * (X[t-1,i+1,j] - X[t-1,i-1,j]) * (X[t-1,i+1,j] - X[t-1,i-1,j]) + (Y[t-1,i+1,j] - Y[t-1,i-1,j]) * (Y[t-1,i+1,j] - Y[t-1,i-1,j])) * (X[t-1,i,j+1] - (2.0 * X[t-1,i,j]) + X[t-1,i,j-1]) - (0.125 * (X[t-1,i+1,j] - X[t-1,i-1,j]) * (X[t-1,i,j+1] - X[t-1,i,j-1]) + (Y[t-1,i+1,j] - Y[t-1,i-1,j]) * (Y[t-1,i,j+1] - Y[t-1,i,j-1])) * (X[t-1,i+1,j+1] - X[t-1,i+1,j-1] - X[t-1,i-1,j+1] + X[t-1,i-1,j-1])) + ((0.25 * (X[t-1,i,j] - X[t-1,i,j-2]) * (X[t-1,i,j] - X[t-1,i,j-2]) + (Y[t-1,i,j] - Y[t-1,i,j-2]) * (Y[t-1,i,j] - Y[t-1,i,j-2])) * (X[t-1,i+1,j-1] - (2.0 * X[t-1,i,j-1]) + X[t-1,i-1,j-1]) + (0.25 * (X[t-1,i+1,j-1] - X[t-1,i-1,j-1]) * (X[t-1,i+1,j-1] - X[t-1,i-1,j-1]) + (Y[t-1,i+1,j-1] - Y[t-1,i-1,j-1]) * (Y[t-1,i+1,j-1] - Y[t-1,i-1,j-1])) * (X[t-1,i,j] - (2.0 * X[t-1,i,j-1]) + X[t-1,i,j-2]) - (0.125 * (X[t-1,i+1,j-1] - X[t-1,i-1,j-1]) * (X[t-1,i,j] - X[t-1,i,j-2]) + (Y[t-1,i+1,j-1] - Y[t-1,i-1,j-1]) * (Y[t-1,i,j] - Y[t-1,i,j-2])) * (X[t-1,i+1,j] - X[t-1,i+1,j-2] - X[t-1,i-1,j] + X[t-1,i-1,j-2])) * (0.25 * (X[t-1,i+1,j] - X[t-1,i-1,j]) * (X[t-1,i+1,j] - X[t-1,i-1,j]) + (Y[t-1,i+1,j] - Y[t-1,i-1,j]) * (Y[t-1,i+1,j] - Y[t-1,i-1,j])) * D[t,i,j-1]) * D[t,i,N-2];
	             {| 1<j<N-2} : (((0.25 * (X[t-1,i,j+1] - X[t-1,i,j-1]) * (X[t-1,i,j+1] - X[t-1,i,j-1]) + (Y[t-1,i,j+1] - Y[t-1,i,j-1]) * (Y[t-1,i,j+1] - Y[t-1,i,j-1])) * (X[t-1,i+1,j] - (2.0 * X[t-1,i,j]) + X[t-1,i-1,j]) + (0.25 * (X[t-1,i+1,j] - X[t-1,i-1,j]) * (X[t-1,i+1,j] - X[t-1,i-1,j]) + (Y[t-1,i+1,j] - Y[t-1,i-1,j]) * (Y[t-1,i+1,j] - Y[t-1,i-1,j])) * (X[t-1,i,j+1] - (2.0 * X[t-1,i,j]) + X[t-1,i,j-1]) - (0.125 * (X[t-1,i+1,j] - X[t-1,i-1,j]) * (X[t-1,i,j+1] - X[t-1,i,j-1]) + (Y[t-1,i+1,j] - Y[t-1,i-1,j]) * (Y[t-1,i,j+1] - Y[t-1,i,j-1])) * (X[t-1,i+1,j+1] - X[t-1,i+1,j-1] - X[t-1,i-1,j+1] + X[t-1,i-1,j-1])) + ((0.25 * (X[t-1,i,j] - X[t-1,i,j-2]) * (X[t-1,i,j] - X[t-1,i,j-2]) + (Y[t-1,i,j] - Y[t-1,i,j-2]) * (Y[t-1,i,j] - Y[t-1,i,j-2])) * (X[t-1,i+1,j-1] - (2.0 * X[t-1,i,j-1]) + X[t-1,i-1,j-1]) + (0.25 * (X[t-1,i+1,j-1] - X[t-1,i-1,j-1]) * (X[t-1,i+1,j-1] - X[t-1,i-1,j-1]) + (Y[t-1,i+1,j-1] - Y[t-1,i-1,j-1]) * (Y[t-1,i+1,j-1] - Y[t-1,i-1,j-1])) * (X[t-1,i,j] - (2.0 * X[t-1,i,j-1]) + X[t-1,i,j-2]) - (0.125 * (X[t-1,i+1,j-1] - X[t-1,i-1,j-1]) * (X[t-1,i,j] - X[t-1,i,j-2]) + (Y[t-1,i+1,j-1] - Y[t-1,i-1,j-1]) * (Y[t-1,i,j] - Y[t-1,i,j-2])) * (X[t-1,i+1,j] - X[t-1,i+1,j-2] - X[t-1,i-1,j] + X[t-1,i-1,j-2])) * (0.25 * (X[t-1,i+1,j] - X[t-1,i-1,j]) * (X[t-1,i+1,j] - X[t-1,i-1,j]) + (Y[t-1,i+1,j] - Y[t-1,i-1,j]) * (Y[t-1,i+1,j] - Y[t-1,i-1,j])) * D[t,i,j-1]) + (0.25 * (X[t-1,i+1,j] - X[t-1,i-1,j]) * (X[t-1,i+1,j] - X[t-1,i-1,j]) + (Y[t-1,i+1,j] - Y[t-1,i-1,j]) * (Y[t-1,i+1,j] - Y[t-1,i-1,j])) * (((0.25 * (X[t-1,i,j+1] - X[t-1,i,j-1]) * (X[t-1,i,j+1] - X[t-1,i,j-1]) + (Y[t-1,i,j+1] - Y[t-1,i,j-1]) * (Y[t-1,i,j+1] - Y[t-1,i,j-1])) * (X[t-1,i+1,j] - (2.0 * X[t-1,i,j]) + X[t-1,i-1,j]) + (0.25 * (X[t-1,i+1,j] - X[t-1,i-1,j]) * (X[t-1,i+1,j] - X[t-1,i-1,j]) + (Y[t-1,i+1,j] - Y[t-1,i-1,j]) * (Y[t-1,i+1,j] - Y[t-1,i-1,j])) * (X[t-1,i,j+1] - (2.0 * X[t-1,i,j]) + X[t-1,i,j-1]) - (0.125 * (X[t-1,i+1,j] - X[t-1,i-1,j]) * (X[t-1,i,j+1] - X[t-1,i,j-1]) + (Y[t-1,i+1,j] - Y[t-1,i-1,j]) * (Y[t-1,i,j+1] - Y[t-1,i,j-1])) * (X[t-1,i+1,j+1] - X[t-1,i+1,j-1] - X[t-1,i-1,j+1] + X[t-1,i-1,j-1])) + ((0.25 * (X[t-1,i,j] - X[t-1,i,j-2]) * (X[t-1,i,j] - X[t-1,i,j-2]) + (Y[t-1,i,j] - Y[t-1,i,j-2]) * (Y[t-1,i,j] - Y[t-1,i,j-2])) * (X[t-1,i+1,j-1] - (2.0 * X[t-1,i,j-1]) + X[t-1,i-1,j-1]) + (0.25 * (X[t-1,i+1,j-1] - X[t-1,i-1,j-1]) * (X[t-1,i+1,j-1] - X[t-1,i-1,j-1]) + (Y[t-1,i+1,j-1] - Y[t-1,i-1,j-1]) * (Y[t-1,i+1,j-1] - Y[t-1,i-1,j-1])) * (X[t-1,i,j] - (2.0 * X[t-1,i,j-1]) + X[t-1,i,j-2]) - (0.125 * (X[t-1,i+1,j-1] - X[t-1,i-1,j-1]) * (X[t-1,i,j] - X[t-1,i,j-2]) + (Y[t-1,i+1,j-1] - Y[t-1,i-1,j-1]) * (Y[t-1,i,j] - Y[t-1,i,j-2])) * (X[t-1,i+1,j] - X[t-1,i+1,j-2] - X[t-1,i-1,j] + X[t-1,i-1,j-2])) * (0.25 * (X[t-1,i+1,j+1] - X[t-1,i-1,j+1]) * (X[t-1,i+1,j+1] - X[t-1,i-1,j+1]) + (Y[t-1,i+1,j+1] - Y[t-1,i-1,j+1]) * (Y[t-1,i+1,j+1] - Y[t-1,i-1,j+1])) * D[t,i,j]) * D[t,i,j];
	             esac;
	RY[t,i,j] = case
	             {| j==1} : ((0.25 * (X[t-1,i,j+1] - X[t-1,i,j-1]) * (X[t-1,i,j+1] - X[t-1,i,j-1]) + (Y[t-1,i,j+1] - Y[t-1,i,j-1]) * (Y[t-1,i,j+1] - Y[t-1,i,j-1])) * (Y[t-1,i+1,j] - (2.0 * Y[t-1,i,j]) + Y[t-1,i-1,j]) + (0.25 * (X[t-1,i+1,j] - X[t-1,i-1,j]) * (X[t-1,i+1,j] - X[t-1,i-1,j]) + (Y[t-1,i+1,j] - Y[t-1,i-1,j]) * (Y[t-1,i+1,j] - Y[t-1,i-1,j])) * (Y[t-1,i,j+1] - (2.0 * Y[t-1,i,j]) + Y[t-1,i,j-1]) - (0.125 * (X[t-1,i+1,j] - X[t-1,i-1,j]) * (X[t-1,i,j+1] - X[t-1,i,j-1]) + (Y[t-1,i+1,j] - Y[t-1,i-1,j]) * (Y[t-1,i,j+1] - Y[t-1,i,j-1])) * (Y[t-1,i+1,j+1] - Y[t-1,i+1,j-1] - Y[t-1,i-1,j+1] + Y[t-1,i-1,j-1])) + (0.25 * (X[t-1,i+1,j] - X[t-1,i-1,j]) * (X[t-1,i+1,j] - X[t-1,i-1,j]) + (Y[t-1,i+1,j] - Y[t-1,i-1,j]) * (Y[t-1,i+1,j] - Y[t-1,i-1,j])) * ((0.25 * (X[t-1,i,j+2] - X[t-1,i,j]) * (X[t-1,i,j+2] - X[t-1,i,j]) + (Y[t-1,i,j+2] - Y[t-1,i,j]) * (Y[t-1,i,j+2] - Y[t-1,i,j])) * (Y[t-1,i+1,j+1] - (2.0 * Y[t-1,i,j+1]) + Y[t-1,i-1,j+1]) + (0.25 * (X[t-1,i+1,j+1] - X[t-1,i-1,j+1]) * (X[t-1,i+1,j+1] - X[t-1,i-1,j+1]) + (Y[t-1,i+1,j+1] - Y[t-1,i-1,j+1]) * (Y[t-1,i+1,j+1] - Y[t-1,i-1,j+1])) * (Y[t-1,i,j+2] - (2.0 * Y[t-1,i,j+1]) + Y[t-1,i,j]) - (0.125 * (X[t-1,i+1,j+1] - X[t-1,i-1,j+1]) * (X[t-1,i,j+2] - X[t-1,i,j]) + (Y[t-1,i+1,j+1] - Y[t-1,i-1,j+1]) * (Y[t-1,i,j+2] - Y[t-1,i,j])) * (Y[t-1,i+1,j+2] - Y[t-1,i+1,j] - Y[t-1,i-1,j+2] + Y[t-1,i-1,j])) * D[t,i,j];
	             {| j==N-2} : (((0.25 * (X[t-1,i,j+1] - X[t-1,i,j-1]) * (X[t-1,i,j+1] - X[t-1,i,j-1]) + (Y[t-1,i,j+1] - Y[t-1,i,j-1]) * (Y[t-1,i,j+1] - Y[t-1,i,j-1])) * (Y[t-1,i+1,j] - (2.0 * Y[t-1,i,j]) + Y[t-1,i-1,j]) + (0.25 * (X[t-1,i+1,j] - X[t-1,i-1,j]) * (X[t-1,i+1,j] - X[t-1,i-1,j]) + (Y[t-1,i+1,j] - Y[t-1,i-1,j]) * (Y[t-1,i+1,j] - Y[t-1,i-1,j])) * (Y[t-1,i,j+1] - (2.0 * Y[t-1,i,j]) + Y[t-1,i,j-1]) - (0.125 * (X[t-1,i+1,j] - X[t-1,i-1,j]) * (X[t-1,i,j+1] - X[t-1,i,j-1]) + (Y[t-1,i+1,j] - Y[t-1,i-1,j]) * (Y[t-1,i,j+1] - Y[t-1,i,j-1])) * (Y[t-1,i+1,j+1] - Y[t-1,i+1,j-1] - Y[t-1,i-1,j+1] + Y[t-1,i-1,j-1])) + ((0.25 * (X[t-1,i,j] - X[t-1,i,j-2]) * (X[t-1,i,j] - X[t-1,i,j-2]) + (Y[t-1,i,j] - Y[t-1,i,j-2]) * (Y[t-1,i,j] - Y[t-1,i,j-2])) * (Y[t-1,i+1,j-1] - (2.0 * Y[t-1,i,j-1]) + Y[t-1,i-1,j-1]) + (0.25 * (X[t-1,i+1,j-1] - X[t-1,i-1,j-1]) * (X[t-1,i+1,j-1] - X[t-1,i-1,j-1]) + (Y[t-1,i+1,j-1] - Y[t-1,i-1,j-1]) * (Y[t-1,i+1,j-1] - Y[t-1,i-1,j-1])) * (Y[t-1,i,j] - (2.0 * Y[t-1,i,j-1]) + Y[t-1,i,j-2]) - (0.125 * (X[t-1,i+1,j-1] - X[t-1,i-1,j-1]) * (X[t-1,i,j] - X[t-1,i,j-2]) + (Y[t-1,i+1,j-1] - Y[t-1,i-1,j-1]) * (Y[t-1,i,j] - Y[t-1,i,j-2])) * (Y[t-1,i+1,j] - Y[t-1,i+1,j-2] - Y[t-1,i-1,j] + Y[t-1,i-1,j-2])) * (0.25 * (X[t-1,i+1,j] - X[t-1,i-1,j]) * (X[t-1,i+1,j] - X[t-1,i-1,j]) + (Y[t-1,i+1,j] - Y[t-1,i-1,j]) * (Y[t-1,i+1,j] - Y[t-1,i-1,j])) * D[t,i,j-1]) * D[t,i,N-2];
	             {| 1<j<N-2} : (((0.25 * (X[t-1,i,j+1] - X[t-1,i,j-1]) * (X[t-1,i,j+1] - X[t-1,i,j-1]) + (Y[t-1,i,j+1] - Y[t-1,i,j-1]) * (Y[t-1,i,j+1] - Y[t-1,i,j-1])) * (Y[t-1,i+1,j] - (2.0 * Y[t-1,i,j]) + Y[t-1,i-1,j]) + (0.25 * (X[t-1,i+1,j] - X[t-1,i-1,j]) * (X[t-1,i+1,j] - X[t-1,i-1,j]) + (Y[t-1,i+1,j] - Y[t-1,i-1,j]) * (Y[t-1,i+1,j] - Y[t-1,i-1,j])) * (Y[t-1,i,j+1] - (2.0 * Y[t-1,i,j]) + Y[t-1,i,j-1]) - (0.125 * (X[t-1,i+1,j] - X[t-1,i-1,j]) * (X[t-1,i,j+1] - X[t-1,i,j-1]) + (Y[t-1,i+1,j] - Y[t-1,i-1,j]) * (Y[t-1,i,j+1] - Y[t-1,i,j-1])) * (Y[t-1,i+1,j+1] - Y[t-1,i+1,j-1] - Y[t-1,i-1,j+1] + Y[t-1,i-1,j-1])) + ((0.25 * (X[t-1,i,j] - X[t-1,i,j-2]) * (X[t-1,i,j] - X[t-1,i,j-2]) + (Y[t-1,i,j] - Y[t-1,i,j-2]) * (Y[t-1,i,j] - Y[t-1,i,j-2])) * (Y[t-1,i+1,j-1] - (2.0 * Y[t-1,i,j-1]) + Y[t-1,i-1,j-1]) + (0.25 * (X[t-1,i+1,j-1] - X[t-1,i-1,j-1]) * (X[t-1,i+1,j-1] - X[t-1,i-1,j-1]) + (Y[t-1,i+1,j-1] - Y[t-1,i-1,j-1]) * (Y[t-1,i+1,j-1] - Y[t-1,i-1,j-1])) * (Y[t-1,i,j] - (2.0 * Y[t-1,i,j-1]) + Y[t-1,i,j-2]) - (0.125 * (X[t-1,i+1,j-1] - X[t-1,i-1,j-1]) * (X[t-1,i,j] - X[t-1,i,j-2]) + (Y[t-1,i+1,j-1] - Y[t-1,i-1,j-1]) * (Y[t-1,i,j] - Y[t-1,i,j-2])) * (Y[t-1,i+1,j] - Y[t-1,i+1,j-2] - Y[t-1,i-1,j] + Y[t-1,i-1,j-2])) * (0.25 * (X[t-1,i+1,j] - X[t-1,i-1,j]) * (X[t-1,i+1,j] - X[t-1,i-1,j]) + (Y[t-1,i+1,j] - Y[t-1,i-1,j]) * (Y[t-1,i+1,j] - Y[t-1,i-1,j])) * D[t,i,j-1]) + (0.25 * (X[t-1,i+1,j] - X[t-1,i-1,j]) * (X[t-1,i+1,j] - X[t-1,i-1,j]) + (Y[t-1,i+1,j] - Y[t-1,i-1,j]) * (Y[t-1,i+1,j] - Y[t-1,i-1,j])) * D[t,i,j] * (((0.25 * (X[t-1,i,j+1] - X[t-1,i,j-1]) * (X[t-1,i,j+1] - X[t-1,i,j-1]) + (Y[t-1,i,j+1] - Y[t-1,i,j-1]) * (Y[t-1,i,j+1] - Y[t-1,i,j-1])) * (Y[t-1,i+1,j] - (2.0 * Y[t-1,i,j]) + Y[t-1,i-1,j]) + (0.25 * (X[t-1,i+1,j] - X[t-1,i-1,j]) * (X[t-1,i+1,j] - X[t-1,i-1,j]) + (Y[t-1,i+1,j] - Y[t-1,i-1,j]) * (Y[t-1,i+1,j] - Y[t-1,i-1,j])) * (Y[t-1,i,j+1] - (2.0 * Y[t-1,i,j]) + Y[t-1,i,j-1]) - (0.125 * (X[t-1,i+1,j] - X[t-1,i-1,j]) * (X[t-1,i,j+1] - X[t-1,i,j-1]) + (Y[t-1,i+1,j] - Y[t-1,i-1,j]) * (Y[t-1,i,j+1] - Y[t-1,i,j-1])) * (Y[t-1,i+1,j+1] - Y[t-1,i+1,j-1] - Y[t-1,i-1,j+1] + Y[t-1,i-1,j-1])) + ((0.25 * (X[t-1,i,j] - X[t-1,i,j-2]) * (X[t-1,i,j] - X[t-1,i,j-2]) + (Y[t-1,i,j] - Y[t-1,i,j-2]) * (Y[t-1,i,j] - Y[t-1,i,j-2])) * (Y[t-1,i+1,j-1] - (2.0 * Y[t-1,i,j-1]) + Y[t-1,i-1,j-1]) + (0.25 * (X[t-1,i+1,j-1] - X[t-1,i-1,j-1]) * (X[t-1,i+1,j-1] - X[t-1,i-1,j-1]) + (Y[t-1,i+1,j-1] - Y[t-1,i-1,j-1]) * (Y[t-1,i+1,j-1] - Y[t-1,i-1,j-1])) * (Y[t-1,i,j] - (2.0 * Y[t-1,i,j-1]) + Y[t-1,i,j-2]) - (0.125 * (X[t-1,i+1,j-1] - X[t-1,i-1,j-1]) * (X[t-1,i,j] - X[t-1,i,j-2]) + (Y[t-1,i+1,j-1] - Y[t-1,i-1,j-1]) * (Y[t-1,i,j] - Y[t-1,i,j-2])) * (Y[t-1,i+1,j] - Y[t-1,i+1,j-2] - Y[t-1,i-1,j] + Y[t-1,i-1,j-2])) * (0.25 * (X[t-1,i+1,j+1] - X[t-1,i-1,j+1]) * (X[t-1,i+1,j+1] - X[t-1,i-1,j+1]) + (Y[t-1,i+1,j+1] - Y[t-1,i-1,j+1]) * (Y[t-1,i+1,j+1] - Y[t-1,i-1,j+1])) * D[t,i,j]);
	             esac;
	X  [t,i,j] = case
	             {| t==0} ||
	             {| i==0} ||
	             {| j==0} ||
	             {| i==N-1} ||
	             {| j==N-1} : X0[i,j];
	             {| 0<t<=ITACT && 1<=i<N-1 && 1<=j<N-1} : X[t-1,i,j] + RX[t,i,j];
	             esac;
	Y  [t,i,j] = case
	             {| t==0} ||
	             {| i==0} ||
	             {| j==0} ||
	             {| i==N-1} ||
	             {| j==N-1} : Y0[i,j];
	             {| 0<t<=ITACT && 1<=i<N-1 && 1<=j<N-1} : Y[t-1,i,j] + RY[t,i,j];
	             esac;
	/* X  [t,i,j] = reduce(+, [m], {| 0<=m<=t} : RX[m,i,j]) + X0[i,j];
	Y  [t,i,j] = reduce(+, [m], {| 0<=m<=t} : RY[m,i,j]) + Y0[i,j]; */
	RXM[t    ] = reduce(max, [k,l], {| 1<=(k,l)<N-1} : abs((0.25 * (X[t-1,k,l+1] - X[t-1,k,l-1]) * (X[t-1,k,l+1] - X[t-1,k,l-1]) + (Y[t-1,k,l+1] - Y[t-1,k,l-1]) * (Y[t-1,k,l+1] - Y[t-1,k,l-1])) * (X[t-1,k+1,l] - (2.0 * X[t-1,k,l]) + X[t-1,k-1,l]) + (0.25 * (X[t-1,k+1,l] - X[t-1,k-1,l]) * (X[t-1,k+1,l] - X[t-1,k-1,l]) + (Y[t-1,k+1,l] - Y[t-1,k-1,l]) * (Y[t-1,k+1,l] - Y[t-1,k-1,l])) * (X[t-1,k,l+1] - (2.0 * X[t-1,k,l]) + X[t-1,k,l-1]) - (0.125 * (X[t-1,k+1,l] - X[t-1,k-1,l]) * (X[t-1,k,l+1] - X[t-1,k,l-1]) + (Y[t-1,k+1,l] - Y[t-1,k-1,l]) * (Y[t-1,k,l+1] - Y[t-1,k,l-1])) * (X[t-1,k+1,l+1] - X[t-1,k+1,l-1] - X[t-1,k-1,l+1] + X[t-1,k-1,l-1])));
	RYM[t    ] = reduce(max, [k,l], {| 1<=(k,l)<N-1} : abs((0.25 * (X[t-1,k,l+1] - X[t-1,k,l-1]) * (X[t-1,k,l+1] - X[t-1,k,l-1]) + (Y[t-1,k,l+1] - Y[t-1,k,l-1]) * (Y[t-1,k,l+1] - Y[t-1,k,l-1])) * (Y[t-1,k+1,l] - (2.0 * Y[t-1,k,l]) + Y[t-1,k-1,l]) + (0.25 * (X[t-1,k+1,l] - X[t-1,k-1,l]) * (X[t-1,k+1,l] - X[t-1,k-1,l]) + (Y[t-1,k+1,l] - Y[t-1,k-1,l]) * (Y[t-1,k+1,l] - Y[t-1,k-1,l])) * (Y[t-1,k,l+1] - (2.0 * Y[t-1,k,l]) + Y[t-1,k,l-1]) - (0.125 * (X[t-1,k+1,l] - X[t-1,k-1,l]) * (X[t-1,k,l+1] - X[t-1,k,l-1]) + (Y[t-1,k+1,l] - Y[t-1,k-1,l]) * (Y[t-1,k,l+1] - Y[t-1,k,l-1])) * (Y[t-1,k+1,l+1] - Y[t-1,k+1,l-1] - Y[t-1,k-1,l+1] + Y[t-1,k-1,l-1])));
.

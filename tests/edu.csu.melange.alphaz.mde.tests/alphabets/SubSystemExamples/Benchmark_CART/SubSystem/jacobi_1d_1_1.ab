affine jacobi_1d {TSTEPSb,Nb,TSTEPSl,Nl,b|Nb==0 && TSTEPSb>=1 && TSTEPSl>=0 && Nl>=6 && b>=TSTEPSl+1 && b>=Nl+1} || {TSTEPSb,Nb,TSTEPSl,Nl,b|TSTEPSb==0 && Nb>=2 && TSTEPSl>=3 && Nl>=0 && b>=TSTEPSl+1 && b>=Nl+1} || {TSTEPSb,Nb,TSTEPSl,Nl,b|Nb==1 && TSTEPSb>=1 && TSTEPSl>=0 && Nl>=0 && b>=TSTEPSl+1 && b>=Nl+1 && Nl+b>=6} || {TSTEPSb,Nb,TSTEPSl,Nl,b|Nb==0 && TSTEPSb==0 && TSTEPSl>=3 && Nl>=6 && b>=TSTEPSl+1 && b>=Nl+1} || {TSTEPSb,Nb,TSTEPSl,Nl,b|Nb==1 && TSTEPSb==0 && TSTEPSl>=3 && Nl>=0 && b>=TSTEPSl+1 && b>=Nl+1 && Nl+b>=6} || {TSTEPSb,Nb,TSTEPSl,Nl,b|TSTEPSb>=1 && Nb>=2 && TSTEPSl>=0 && Nl>=0 && b>=TSTEPSl+1 && b>=Nl+1 && b>=4}
input
output
double B_bl {tBl,iBl,tLoc,iLoc|tLoc==TSTEPSl && tBl==TSTEPSb && TSTEPSb+Nb>=iBl+1 && iBl>=TSTEPSb+1 && TSTEPSb>=1 && b>=iLoc+1 && iLoc>=0} || {tBl,iBl,tLoc,iLoc|tLoc==TSTEPSl && iBl==TSTEPSb && tBl==TSTEPSb && Nb>=2 && b>=iLoc+1 && iLoc>=TSTEPSl && TSTEPSb>=1} || {tBl,iBl,tLoc,iLoc|tLoc==TSTEPSl && tBl==0 && TSTEPSb==0 && iLoc>=0 && TSTEPSl>=3 && b>=iLoc+1 && iBl>=1 && Nb>=iBl+1} || {tBl,iBl,tLoc,iLoc|tLoc==TSTEPSl && iBl==TSTEPSb+Nb+1 && tBl==TSTEPSb && Nb>=1 && TSTEPSl+Nl>=iLoc+b+1 && iLoc>=0 && TSTEPSb>=1} || {tBl,iBl,tLoc,iLoc|tLoc==TSTEPSl && iBl==TSTEPSb+Nb && tBl==TSTEPSb && b>=iLoc+1 && iLoc>=0 && TSTEPSb>=1 && Nb>=2 && TSTEPSl+Nl>=iLoc+1} || {tBl,iBl,tLoc,iLoc|tLoc==TSTEPSl && iBl==0 && tBl==0 && TSTEPSb==0 && iLoc>=TSTEPSl && b>=iLoc+1 && Nb>=2 && TSTEPSl>=3} || {tBl,iBl,tLoc,iLoc|tLoc==TSTEPSl && iBl==Nb+1 && tBl==0 && TSTEPSb==0 && TSTEPSl+Nl>=iLoc+b+1 && iLoc>=0 && Nb>=1 && TSTEPSl>=3} || {tBl,iBl,tLoc,iLoc|tLoc==TSTEPSl && iBl==TSTEPSb && tBl==TSTEPSb && Nb==1 && iLoc>=TSTEPSl && Nl+b>=6 && TSTEPSb>=1 && b>=iLoc+1} || {tBl,iBl,tLoc,iLoc|tLoc==TSTEPSl && iBl==Nb && tBl==0 && TSTEPSb==0 && b>=iLoc+1 && Nb>=2 && TSTEPSl>=3 && TSTEPSl+Nl>=iLoc+1 && iLoc>=0} || {tBl,iBl,tLoc,iLoc|tLoc==TSTEPSl && iBl==TSTEPSb && tBl==TSTEPSb && Nb==0 && iLoc>=TSTEPSl && TSTEPSb>=1 && TSTEPSl+Nl>=iLoc+1 && Nl>=6 && b>=iLoc+1} || {tBl,iBl,tLoc,iLoc|tLoc==TSTEPSl && iBl==TSTEPSb+1 && tBl==TSTEPSb && Nb==1 && Nl+b>=6 && TSTEPSb>=1 && TSTEPSl+Nl>=iLoc+1 && b>=iLoc+1 && iLoc>=0} || {tBl,iBl,tLoc,iLoc|tLoc==TSTEPSl && iBl==TSTEPSb+1 && tBl==TSTEPSb && Nb==0 && Nl>=6 && iLoc>=0 && TSTEPSb>=1 && TSTEPSl+Nl>=iLoc+b+1} || {tBl,iBl,tLoc,iLoc|tLoc==TSTEPSl && iBl==0 && tBl==0 && Nb==1 && TSTEPSb==0 && b>=iLoc+1 && TSTEPSl>=3 && Nl+b>=6 && iLoc>=TSTEPSl} || {tBl,iBl,tLoc,iLoc|tLoc==TSTEPSl && iBl==0 && tBl==0 && Nb==0 && TSTEPSb==0 && TSTEPSl>=3 && Nl>=6 && iLoc>=TSTEPSl && b>=iLoc+1 && TSTEPSl+Nl>=iLoc+1} || {tBl,iBl,tLoc,iLoc|tLoc==TSTEPSl && iBl==1 && tBl==0 && Nb==1 && TSTEPSb==0 && TSTEPSl>=3 && TSTEPSl+Nl>=iLoc+1 && Nl+b>=6 && iLoc>=0 && b>=iLoc+1} || {tBl,iBl,tLoc,iLoc|tLoc==TSTEPSl && iBl==1 && tBl==0 && Nb==0 && TSTEPSb==0 && iLoc>=0 && TSTEPSl>=3 && Nl>=6 && TSTEPSl+Nl>=iLoc+b+1};
local
double temp_B_bl {tBl,iBl,tLoc,iLoc|tBl>=0 && TSTEPSb>=tBl+1 && iBl>=tBl+1 && tBl+Nb>=iBl+1 && tLoc>=0 && b>=tLoc+1 && iLoc>=0 && b>=iLoc+1} || {tBl,iBl,tLoc,iLoc|iBl==tBl && iLoc>=tLoc && Nb>=2 && b>=iLoc+1 && tBl>=0 && TSTEPSb>=tBl+1 && tLoc>=0} || {tBl,iBl,tLoc,iLoc|iBl==tBl+Nb+1 && b>=tLoc+1 && Nb>=1 && tLoc+Nl>=iLoc+b+1 && tBl>=0 && TSTEPSb>=tBl+1 && iLoc>=0} || {tBl,iBl,tLoc,iLoc|tBl==TSTEPSb && TSTEPSb>=1 && b>=iLoc+1 && iBl>=TSTEPSb+1 && TSTEPSb+Nb>=iBl+1 && tLoc>=0 && iLoc>=0 && TSTEPSl>=tLoc+1} || {tBl,iBl,tLoc,iLoc|iBl==tBl+Nb && tLoc+Nl>=iLoc+1 && tBl>=0 && TSTEPSb>=tBl+1 && tLoc>=0 && b>=tLoc+1 && iLoc>=0 && b>=iLoc+1 && Nb>=2} || {tBl,iBl,tLoc,iLoc|iBl==TSTEPSb && tBl==TSTEPSb && iLoc>=tLoc && TSTEPSb>=1 && Nb>=2 && b>=iLoc+1 && tLoc>=0 && TSTEPSl>=tLoc+1} || {tBl,iBl,tLoc,iLoc|iBl==tBl && Nb==1 && b>=iLoc+1 && Nl+b>=6 && tBl>=0 && TSTEPSb>=tBl+1 && tLoc>=0 && iLoc>=tLoc} || {tBl,iBl,tLoc,iLoc|iBl==tBl && Nb==0 && tLoc+Nl>=iLoc+1 && tBl>=0 && TSTEPSb>=tBl+1 && tLoc>=0 && iLoc>=tLoc && b>=iLoc+1 && Nl>=6} || {tBl,iBl,tLoc,iLoc|iBl==TSTEPSb+Nb+1 && tBl==TSTEPSb && TSTEPSl>=tLoc+1 && iLoc>=0 && TSTEPSb>=1 && Nb>=1 && tLoc+Nl>=iLoc+b+1} || {tBl,iBl,tLoc,iLoc|iBl==tBl+1 && Nb==1 && tBl>=0 && TSTEPSb>=tBl+1 && tLoc>=0 && b>=tLoc+1 && iLoc>=0 && b>=iLoc+1 && tLoc+Nl>=iLoc+1 && Nl+b>=6} || {tBl,iBl,tLoc,iLoc|iBl==tBl+1 && Nb==0 && Nl>=6 && tLoc+Nl>=iLoc+b+1 && tBl>=0 && TSTEPSb>=tBl+1 && iLoc>=0 && b>=tLoc+1} || {tBl,iBl,tLoc,iLoc|iBl==TSTEPSb+Nb && tBl==TSTEPSb && TSTEPSb>=1 && Nb>=2 && tLoc+Nl>=iLoc+1 && tLoc>=0 && b>=iLoc+1 && TSTEPSl>=tLoc+1 && iLoc>=0} || {tBl,iBl,tLoc,iLoc|tBl==0 && TSTEPSb==0 && b>=iLoc+1 && iBl>=1 && Nb>=iBl+1 && tLoc>=0 && iLoc>=0 && TSTEPSl>=tLoc+1 && TSTEPSl>=3} || {tBl,iBl,tLoc,iLoc|iBl==TSTEPSb && tBl==TSTEPSb && Nb==1 && TSTEPSb>=1 && b>=iLoc+1 && Nl+b>=6 && tLoc>=0 && TSTEPSl>=tLoc+1 && iLoc>=tLoc} || {tBl,iBl,tLoc,iLoc|iBl==0 && tBl==0 && TSTEPSb==0 && Nb>=2 && TSTEPSl>=3 && b>=iLoc+1 && tLoc>=0 && TSTEPSl>=tLoc+1 && iLoc>=tLoc} || {tBl,iBl,tLoc,iLoc|iBl==TSTEPSb && tBl==TSTEPSb && Nb==0 && Nl>=6 && tLoc+Nl>=iLoc+1 && tLoc>=0 && TSTEPSl>=tLoc+1 && iLoc>=tLoc && b>=iLoc+1 && TSTEPSb>=1} || {tBl,iBl,tLoc,iLoc|iBl==TSTEPSb+1 && tBl==TSTEPSb && Nb==1 && tLoc+Nl>=iLoc+1 && Nl+b>=6 && tLoc>=0 && b>=iLoc+1 && TSTEPSl>=tLoc+1 && iLoc>=0 && TSTEPSb>=1} || {tBl,iBl,tLoc,iLoc|iBl==TSTEPSb+1 && tBl==TSTEPSb && Nb==0 && iLoc>=0 && TSTEPSb>=1 && Nl>=6 && tLoc+Nl>=iLoc+b+1 && TSTEPSl>=tLoc+1} || {tBl,iBl,tLoc,iLoc|iBl==Nb+1 && tBl==0 && TSTEPSb==0 && tLoc+Nl>=iLoc+b+1 && TSTEPSl>=tLoc+1 && Nb>=1 && iLoc>=0} || {tBl,iBl,tLoc,iLoc|iBl==Nb && tBl==0 && TSTEPSb==0 && TSTEPSl>=3 && tLoc+Nl>=iLoc+1 && tLoc>=0 && b>=iLoc+1 && TSTEPSl>=tLoc+1 && iLoc>=0 && Nb>=2} || {tBl,iBl,tLoc,iLoc|iBl==0 && tBl==0 && Nb==1 && TSTEPSb==0 && b>=iLoc+1 && Nl+b>=6 && tLoc>=0 && TSTEPSl>=tLoc+1 && iLoc>=tLoc && TSTEPSl>=3} || {tBl,iBl,tLoc,iLoc|iBl==0 && tBl==0 && Nb==0 && TSTEPSb==0 && tLoc+Nl>=iLoc+1 && tLoc>=0 && TSTEPSl>=tLoc+1 && iLoc>=tLoc && b>=iLoc+1 && TSTEPSl>=3 && Nl>=6} || {tBl,iBl,tLoc,iLoc|iBl==1 && tBl==0 && Nb==1 && TSTEPSb==0 && Nl+b>=6 && tLoc>=0 && b>=iLoc+1 && TSTEPSl>=tLoc+1 && iLoc>=0 && TSTEPSl>=3 && tLoc+Nl>=iLoc+1} || {tBl,iBl,tLoc,iLoc|iBl==1 && tBl==0 && Nb==0 && TSTEPSb==0 && TSTEPSl>=tLoc+1 && iLoc>=0 && Nl>=6 && tLoc+Nl>=iLoc+b+1};
let
temp_B_bl[tBl,iBl,tLoc,iLoc] = case
{|tBl+Nb>=iBl+1 && TSTEPSb>=tBl+1 && Nb>=2} || {|iBl==tBl+Nb+1 && TSTEPSb>=tBl+1 && Nb>=1 && Nl>=2} || {|iBl==tBl+Nb && Nb>=2 && TSTEPSb>=tBl+1 && Nl+b>=2} || {|Nb==1 && tBl>=iBl-1 && Nl+b>=6 && TSTEPSb>=tBl+1} || {|tBl==TSTEPSb && TSTEPSl>=1 && TSTEPSb>=1 && TSTEPSb+Nb>=iBl+1} || {|Nb==0 && Nl>=6 && TSTEPSb>=tBl+1} || {|tBl==0 && TSTEPSb==0 && Nb>=2 && TSTEPSl>=3 && Nb>=iBl+1} || {|iBl==TSTEPSb+Nb+1 && tBl==TSTEPSb && TSTEPSl>=1 && Nl>=2 && TSTEPSl+Nl>=b+2 && TSTEPSb>=1 && Nb>=1} || {|iBl==TSTEPSb+Nb && tBl==TSTEPSb && TSTEPSl>=1 && TSTEPSl+Nl>=2 && Nl+b>=2 && TSTEPSb>=1 && Nb>=2} || {|iBl==1 && tBl==0 && Nb==1 && TSTEPSb==0 && TSTEPSl+Nl>=2 && Nl+b>=6 && TSTEPSl>=3} || {|iBl==1 && tBl==0 && Nb==0 && TSTEPSb==0 && Nl>=6 && TSTEPSl+Nl>=b+2 && TSTEPSl>=3} || {|iBl==2 && tBl==1 && Nb==1 && TSTEPSb==1 && TSTEPSl>=1 && TSTEPSl+Nl>=2 && Nl+b>=6} || {|iBl==2 && tBl==1 && Nb==0 && TSTEPSb==1 && TSTEPSl>=1 && Nl>=6 && TSTEPSl+Nl>=b+2} || {|iBl==Nb+1 && tBl==0 && TSTEPSb==0 && Nl>=2 && TSTEPSl+Nl>=b+2 && Nb>=1 && TSTEPSl>=3} || {|iBl==Nb && tBl==0 && TSTEPSb==0 && TSTEPSl+Nl>=2 && Nl+b>=2 && Nb>=2 && TSTEPSl>=3} || {|iBl==0 && tBl==0 && Nb==1 && TSTEPSb==0 && Nl+b>=6 && TSTEPSl>=3} || {|iBl==0 && tBl==0 && Nb==0 && TSTEPSb==0 && TSTEPSl>=3 && Nl>=6} : case
{|tLoc>=iLoc+1} : temp_B_bl[tBl,-tBl+iBl-1,tLoc,b-tLoc+iLoc];
{|iLoc>=tLoc} : temp_B_bl[tBl,-tBl+iBl,tLoc,-tLoc+iLoc];
esac;
esac;
B_bl[tBl,iBl,tLoc,iLoc] = case
{|} : case
{|} : temp_B_bl[tBl,-tBl+iBl-1,tLoc,b-tLoc+iLoc];
{|} : temp_B_bl[tBl,-tBl+iBl,tLoc,-tLoc+iLoc];
esac;
esac;
.
